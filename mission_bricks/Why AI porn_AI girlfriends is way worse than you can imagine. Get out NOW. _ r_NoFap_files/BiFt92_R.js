SML.di("./CVEbQKiO.js",import.meta.url,"CVEbQKiO");SML.di("./D7lSuCop.js",import.meta.url,"D7lSuCop");SML.di("./CCphb8vV.js",import.meta.url,"CCphb8vV");SML.di("./CITAGWir.js",import.meta.url,"CITAGWir");SML.di("./B011DCe8.js",import.meta.url,"B011DCe8");
SML.dm("BiFt92_R",["CVEbQKiO","D7lSuCop","CCphb8vV","CITAGWir","B011DCe8"],(async(t,e,a,l)=>{let s=class extends t.s{constructor(){super(...arguments),this.isLoading=!0,this.isSubmittable=!1,this.postId="",this._windowEvents=new e.E(this,(()=>window)),this.handleOpenModalEvent=this._windowEvents.define(l.O,(async t=>{this.isSubmittable=!1,this.isLoading=!0,this.showModal(),await this.activateFormContentFeature(t.detail.postId),this.postId=t.detail.postId,this.isLoading=!1}))}get oldPostLevel(){return this.querySelector('[name="old-post-level"]')?.value}get oldIsFilterEnabled(){return"true"===this.querySelector('[name="old-is-filter-enabled"]')?.value}activateFormContentFeature(t){return e.f({name:e.g7,routeParams:{postId:t},renderMode:e.g.Contents})}showModal(){this.modal?.showModal()}closeModal(){this.modal?.close()}buildAlert(t){const l=t?e.a4.success:e.a4.error;return this.dispatchEvent(e.c("faceplate-alert",{level:l,message:a.bG(t)}))}async onSave(){const t=this.querySelector('[name="post-level"][checked]'),e=this.querySelector('[name="is-filter-enabled"]');t?.value&&e?(this.submitRequest(t.value,null!=e.value),this.emitV2Event(t.value,null!=e.value)):(this.buildAlert(!1),this.isSubmittable=!0)}async submitRequest(t,e){try{this.isSubmittable=!1;const a=await this.invokeGQL(t,e);this.inspectResp(a)}catch(t){this.buildAlert(!1),this.isSubmittable=!0}}invokeGQL(t,a){return e.v({operation:e.O.UpdatePostLevelCrowdControlSettings,variables:{id:this.postId,level:t,filterIsEnabled:a,shouldIncludeUpdatePostCrowdControlFilter:a!==this.oldIsFilterEnabled,shouldIncludeUpdatePostCrowdControlLevel:t!==this.oldPostLevel}})}inspectResp(t){let e=!1;"updatePostCrowdControlFilter"in t.data&&"updatePostCrowdControlLevel"in t.data?t.data.updatePostCrowdControlFilter?.ok&&t.data.updatePostCrowdControlLevel?.ok&&(e=!0):"updatePostCrowdControlFilter"in t.data?t.data.updatePostCrowdControlFilter?.ok&&(e=!0):"updatePostCrowdControlLevel"in t.data&&t.data.updatePostCrowdControlLevel?.ok&&(e=!0),e?(this.buildAlert(!0),this.closeModal()):(this.buildAlert(!1),this.isSubmittable=!0)}isContentLoading(){return this.isLoading}emitV2Event(t,e){const a=this.querySelector('[name="subreddit-id"]'),l=this.querySelector('[name="subreddit-name"]'),s={id:a?.value||"",name:l?.value||""},o=this.querySelector('[name="author-id"]'),i={id:this.postId,author:{id:o?.value||""}};this.buildAndTrack("crowd_control_individual_post",i,s,{value:t,old_value:`${this.oldPostLevel}`}),this.buildAndTrack("crowd_control_individual_post_filter",i,s,{value:`${e}`,old_value:`${this.oldIsFilterEnabled}`})}buildAndTrack(t,a,l,s){const o={post:a,subreddit:l,setting:s},i=e.b({source:"post_mod_action_menu",action:"save",noun:t},o);e.e(this,i)}handleInput(){this.isSubmittable=!0}render(){return t.x` <faceplate-modal inFocusTrap class="max-w-md w-full"> <div slot="title"> ${"Adjust post crowd control"} </div> <div slot="closeButton"> ${e.k({appearance:"secondary",leadingIcon:t.C({size:t.q.Small}),size:e._.Small,attributes:{type:"button",onclick:this.closeModal}})} </div> ${this.isLoading?t.x`<div class="w-full"> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-full h-3xl"></faceplate-shimmer> <faceplate-shimmer shape="pill" class="mt-xs mb-xs w-2/3 h-lg"></faceplate-shimmer> </div>`:t.x`<slot @input="${this.handleInput}"></slot>`} <div slot="primaryButton"> ${e.k({children:"Save",appearance:"primary",attributes:{type:"submit",onclick:this.onSave,disabled:!this.isSubmittable}})} </div> <div slot="secondaryButton"> ${e.k({children:"Cancel",appearance:"plain",attributes:{type:"button",onclick:this.closeModal}})} </div> </faceplate-modal> `;}};s.styles=[e.t],t._([t.b()],s.prototype,"isLoading",void 0),t._([t.b()],s.prototype,"isSubmittable",void 0),t._([t.b()],s.prototype,"postId",void 0),t._([t.z("faceplate-modal")],s.prototype,"modal",void 0),s=t._([t.c("post-level-crowd-control-modal")],s)}));