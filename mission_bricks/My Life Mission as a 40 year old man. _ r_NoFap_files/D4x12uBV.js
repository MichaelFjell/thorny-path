SML.di("./aIOFkl2G.js",import.meta.url,"aIOFkl2G");SML.di("./CVEbQKiO.js",import.meta.url,"CVEbQKiO");SML.di("./D7lSuCop.js",import.meta.url,"D7lSuCop");SML.di("./BcR8gLw3.js",import.meta.url,"BcR8gLw3");SML.di("./Dd-egLho.js",import.meta.url,"Dd-egLho");SML.di("./DZMRR9gi.js",import.meta.url,"DZMRR9gi");SML.di("./BZ7lqt1T.js",import.meta.url,"BZ7lqt1T");SML.di("./CCphb8vV.js",import.meta.url,"CCphb8vV");SML.di("./gYqzC9DM.js",import.meta.url,"gYqzC9DM");SML.di("./LbrBbHYe.js",import.meta.url,"LbrBbHYe");SML.di("./CK9FveTr.js",import.meta.url,"CK9FveTr");SML.di("./DKUVnjU0.js",import.meta.url,"DKUVnjU0");SML.di("./Btl6S_1h.js",import.meta.url,"Btl6S_1h");SML.di("./AhHXxeIZ.js",import.meta.url,"AhHXxeIZ");SML.di("./CXpJ8avC.js",import.meta.url,"CXpJ8avC");SML.di("./BUudG9oB.js",import.meta.url,"BUudG9oB");SML.di("./CITAGWir.js",import.meta.url,"CITAGWir");SML.di("./B8BAxqC_.js",import.meta.url,"B8BAxqC_");SML.di("./D9dm-Sy6.js",import.meta.url,"D9dm-Sy6");SML.di("./Mh6HSk7W.js",import.meta.url,"Mh6HSk7W");SML.di("./DkJsPyQM.js",import.meta.url,"DkJsPyQM");SML.di("./CCOsF7IJ.js",import.meta.url,"CCOsF7IJ");SML.di("./BMNJiqQ9.js",import.meta.url,"BMNJiqQ9");SML.di("./BC8XSJYX.js",import.meta.url,"BC8XSJYX");SML.di("./LCU6ttla.js",import.meta.url,"LCU6ttla");
SML.dm("D4x12uBV",["aIOFkl2G","CVEbQKiO","D7lSuCop","BcR8gLw3","Dd-egLho","DZMRR9gi","CCphb8vV","gYqzC9DM","CK9FveTr","BZ7lqt1T","LbrBbHYe","DKUVnjU0","Btl6S_1h","AhHXxeIZ","CXpJ8avC","BUudG9oB","CITAGWir","B8BAxqC_","D9dm-Sy6","Mh6HSk7W","DkJsPyQM","CCOsF7IJ","BMNJiqQ9","BC8XSJYX","LCU6ttla"],(async(e,a,i,n,s,r,o,l,d)=>{const u=a.x`<span class="text-12 text-neutral-content-weak mx-2xs">·</span>`;let m=class extends a.s{constructor(){super(...arguments),this.name="",this.description="",this.shouldShowDefaultImages=!1,this.isSrCreationExperimentEnabled=!1}renderPublicDescriptionText(){return a.x`<p class="m-0 text-ellipsis mb-2xs"> ${0===this.description.length?"Your community description":this.description} </p>`;}renderActiveAndTotalSubscribers(){const e=this.isSrCreationExperimentEnabled?a.x`<span><faceplate-number number="1" pretty></faceplate-number> weekly contributor</span>`:a.x`<span><faceplate-number number="1" pretty></faceplate-number> online</span>`,t=this.isSrCreationExperimentEnabled?a.x`<span><faceplate-number number="1" pretty></faceplate-number> weekly visitor</span>`:l.e(a.x,1,!0);return a.x` <div class="text-12 text-neutral-content-weak"> <span>${t}</span>${a.x`${u}${e}`} </div> `}renderTitleLink(){const e=a.x`<span class="block font-semibold text-20 text-neutral-content-strong hover:text-neutral-content-strong hover:no-underline pb-2xs">r/${0===this.name.length?"communityname":this.name}</span>`;return a.x`${e}`}renderSubredditIcon(){return void 0===this.avatar||""===this.avatar?o._({children:i.k({appearance:"brand",leadingIcon:a.aj({size:a.q.XXLarge}),size:i._.Large,attributes:{tabindex:"-1","aria-hidden":"true"}}),attributes:{tabindex:"-1","aria-hidden":"true"},appearance:"icon",size:"lg"}):a.x`<img loading="lazy" width="42" height="42" class="rounded-[50%] overflow-hidden border-[0.5px] border-solid" src="${this.avatar}" alt="An avatar for the subreddit">`}render(){return a.x`<div class="flex rounded shadow-sm xs:rounded-4 flex-col relative max-w-[268px] grow max-h-[350px] overflow-auto"> ${this.shouldShowDefaultImages||this.banner?this.banner?a.x`<div class="w-100"> <img class="max-w-[100%] w-100 object-cover max-h-[40px] rounded-t-[12px]" src="${this.banner}" alt="Banner"> </div>`:a.x`<div class="w-100 bg-orangered-50 min-h-[32px] max-h-[40px]"></div>`:a.A} <div class="flex justify-start gap-x-md m-md mb-0"> ${this.avatar||this.shouldShowDefaultImages?a.x`<span class="block mt-2xs">${this.renderSubredditIcon()}</span>`:a.A} <div class="flex-col flex justify-center"> ${this.renderTitleLink()} <div>${this.renderActiveAndTotalSubscribers()}</div> </div> </div> <div class="p-sm pt-xs">${this.renderPublicDescriptionText()}</div> </div>`}};m.styles=[i.t],a._([a.n({type:String})],m.prototype,"name",void 0),a._([a.n({type:String})],m.prototype,"description",void 0),a._([a.n({type:String})],m.prototype,"avatar",void 0),a._([a.n({type:String})],m.prototype,"banner",void 0),a._([a.n({type:Boolean,attribute:"show-default-images"})],m.prototype,"shouldShowDefaultImages",void 0),a._([a.n({type:Boolean,attribute:"sr-creation-experiment-enabled"})],m.prototype,"isSrCreationExperimentEnabled",void 0),m=a._([a.c("community-creation-preview")],m);const c=new RegExp("^[A-Za-z0-9][A-Za-z0-9_]{0,20}$"),p=()=>"Tell us about your community",h=(e,t)=>i.bH({one:`${e} of ${t} character`,other:`${e} of ${t} characters`,count:t}),b=a.s;let g=class extends b{constructor(){super(...arguments),this.events=new i.E(this,(()=>window)),this.isSrCreationExperimentEnabled=!1,this.subreddit={name:"",description:""},this.nameTaken=!1,this.validCharsName=!0,this.descriptionTooLong=!1,this.prefixText="",this.handleNameChange=t=>{const a=t.target.value.trim();this.nameInput.value=a,this.subreddit=e.u(this.subreddit,{name:a}),this.prefixText=""!==a?"r/":"",this.validCharsName=c.test(a)||""===a,this.nameTaken&&this.validateNameTaken(),this.nameInputHelperText?.setMessage(this.getNameHelperText(),i.a4.error),this.nameInputHelperText?.requestUpdate()},this.handleDescriptionChange=t=>{const a=t.target.value;this.descriptionInput?.setCustomValidity(""),this.descriptionInputHelperText?.setMessage(""),this.subreddit=e.u(this.subreddit,{description:a}),this.descriptionTooLong=a.length>500,this.descriptionTooLong&&this.setDescriptionTooLong()}}get submitButton(){return this.querySelector('button[type="submit"]')}get nameInput(){return this.shadowRoot?.querySelector('faceplate-text-input[name="name"]')}get descriptionInput(){return this.shadowRoot?.querySelector("faceplate-textarea-input")}get nameInputHelperText(){return this.nameInput?.shadowRoot?.querySelector('faceplate-form-helper-text[name="name"]')}get descriptionInputHelperText(){return this.descriptionInput?.shadowRoot?.querySelector('faceplate-form-helper-text[name="description"]')}async connectedCallback(){super.connectedCallback(),this.prefilledName&&(this.subreddit.name=this.prefilledName??"",await this.updateComplete,await this.validateNameTaken())}async firstUpdated(){await this.updateComplete,this.querySelector("faceplate-pagination-indicator")?.shadowRoot?.querySelectorAll("button.dot").forEach((e=>{e.tabIndex=-1,e.ariaHidden="true"})),this.dispatchEvent(i.c("refresh_focus",{title:p(),ariaLabel:p()+". "+e.S(1)})),this.events.define(s.d,(async e=>{e.stopPropagation(),await this.validateNameTaken(),this.formValid()&&(i.e(this,s.g(this.subreddit.description?.length||0)),this.dispatchSubredditUpdatedEvent("next"))})),this.events.define(s.h,(async e=>{e.stopPropagation(),this.dispatchSubredditUpdatedEvent("back")}))}update(e){this.validateNextButtonDisabled(),super.update(e)}dispatchSubredditUpdatedEvent(t){const a=new CustomEvent(e.U,{bubbles:!0,composed:!0,detail:{subreddit:this.subreddit,direction:t,source:s.C.NameAndDescription}});this.dispatchEvent(a)}dispatchErrors(e){const t=i.c("faceplate-alert",{level:i.a4.error,cause:"uncategorized",message:e});this.dispatchEvent(t)}async validateNameTaken(){if(this.nameTaken||this.nameInput&&this.nameInput.checkValidity()){try{if(null===(await i.v({operation:i.O.CommunityName,variables:{subredditName:this.subreddit.name||""}})).data.subreddit)return this.nameTaken=!1,void this.resetNameInputValidation();i.e(this,s.e({reason:"Name already taken",setting_value:this.subreddit.name})),this.setNameInputTakenValidationMessage()}catch(e){this.dispatchErrors("Server error. Try again later. ")}this.nameTaken=!0}}setNameInputTakenValidationMessage(){this.nameInput?.setCustomValidity("invalid"),this.nameInputHelperText?.setMessage(`"r/${this.subreddit.name}" is already taken`,i.a4.error),this.nameInput?.setCustomValidity("invalid")}setDescriptionTooLong(){this.descriptionInputHelperText?.setMessage("Description is too long.",i.a4.error),this.descriptionInput?.setCustomValidity("invalid")}resetNameInputValidation(){this.nameInput.setCustomValidity(""),this.nameInputHelperText?.setMessage("")}getNameHelperText(){return this.validCharsName?3>this.subreddit.name.length?"Please lengthen this text to 3 characters or more":"":"Only letters, numbers and underscore are allowed";}formValid(){return null!==this.subreddit.name&&this.subreddit.name.length>=3&&this.subreddit.name.length<=21&&null!==this.subreddit.description&&this.subreddit.description.length>=1&&this.subreddit.description.length<=500&&!this.nameTaken&&this.validCharsName}validateNextButtonDisabled(){this.submitButton.disabled=!this.formValid()}render(){return a.x` <div class="xs:w-[752px] h-16 pr-12 py-2.5 rounded-2xl justify-start items-center pb-xl inline-flex"> <div class="grow shrink basis-0 flex-col justify-center items-start gap-[4px] inline-flex"> <div class="self-stretch text-sm font-normal text-tone-2 leading-tight">${"A name and description help people understand what your community is all about."}</div> </div> </div> <div class="mb-0"> <div class="flex gap-md flex-col-reverse flow xs:flex-row"> <div class="min-w-[55%]"> <faceplate-form class="w-100" validation-trigger="change"> <faceplate-text-input data-testid="name-input" class="block flex-1 pb-sm pt-sm" type="text" name="name" helper-text-message="${this.getNameHelperText()}" pattern="^[A-Za-z0-9][A-Za-z0-9_]{2,20}$" maxLength="21" value="${a.l(this.subreddit.name)}" required @input="${this.handleNameChange}" novalidate appearance="${n.a.SECONDARY}" prefix="${a.l(this.prefixText)}" @focusout="${this.validateNameTaken}" character-count character-count-aria-label="${h(this.subreddit.name.length,21)}" helper-text-screen-reader-msg="${"Character count limit reached"}"> <span slot="label"> ${"Community name"} </span> </faceplate-text-input> </faceplate-form> <faceplate-textarea-input size="expanded" appearance="${n.a.SECONDARY}" @input="${this.handleDescriptionChange}" value="${a.l(this.subreddit.description)}" name="description" required novalidate helper-text-message="${"Please shorten this text to 500 characters or less"}" rows="8" class="min-w-full xs:pb-lg" character-count character-count-aria-label="${h(this.subreddit.description.length,500)}"><span slot="label">${"Description"}</span> </faceplate-textarea-input> </div> <div class="flex items-start grow"> <community-creation-preview class="w-100 flex justify-center" name="${a.l(this.subreddit.name)}" description="${a.l(this.subreddit.description)}" sr-creation-experiment-enabled="${this.isSrCreationExperimentEnabled}"></community-creation-preview> </div> </div> <div class="mb-0 pt-[42px]"> <slot name="buttons-bar"></slot> </div> </div> `;}};g.styles=[i.t],a._([a.n({type:String,attribute:"prefilled-name"})],g.prototype,"prefilledName",void 0),a._([a.n({type:Boolean,attribute:"sr-creation-experiment-enabled"})],g.prototype,"isSrCreationExperimentEnabled",void 0),a._([a.b()],g.prototype,"subreddit",void 0),a._([a.b()],g.prototype,"nameTaken",void 0),a._([a.b()],g.prototype,"validCharsName",void 0),a._([a.b()],g.prototype,"descriptionTooLong",void 0),g=a._([a.c("community-creation-name-description")],g);const k=new Set(["tx1_20v2840","tx1_15teiqi","tx1_2b40g1a","tx1_14gsvq1","tx1_18c3qbq","tx1_12l080p","tx1_1nlg6jt","tx1_192ms0u","tx1_1ri658n"]),v=()=>"Add topics",N=3,y=e=>({id:e.id??"",displayName:e.displayName??"",icon:e.icon??null,children:e.children?.map(y)??null}),f=a.s;let I=class extends f{constructor(){super(...arguments),this.events=new i.E(this,(()=>window)),this.subreddit={topics:[]},this.selectedTopics=[],this.topics=[],this._loading=!1,this.maxTopicsSelected=!1,this.gqlTopics=[],this.filter="",this.removeSelected=e=>{this.maxTopicsSelected=!1,this.selectedTopics=this.selectedTopics.filter((t=>t!==e))},this.onTopicsClick=(e,t)=>{this.maxTopicsSelected=!1,e?this.selectedTopics.length<N?(this.selectedTopics.push(t),this.requestUpdate()):this.maxTopicsSelected=!0:this.selectedTopics=this.selectedTopics.filter((e=>e!==t))},this.handleFilterChange=e=>{const t=e.target.value;this.filter=t,this.topics=this.gqlTopics.flatMap((e=>{if(e.displayName.toLowerCase().indexOf(t.toLowerCase())>-1)return[{...e,children:e.children}];{const a=e.children?e.children.filter((e=>e.displayName.toLowerCase().indexOf(t.toLowerCase())>-1)):[];return a.length>0?{...e,children:a}:[]}}))}}get topicsContainer(){return this.shadowRoot.querySelector("#topics")}get submitButton(){return this.querySelector('button[type="submit"]')}async firstUpdated(){this.loadTopics(),await this.updateComplete,this.querySelector("faceplate-pagination-indicator")?.shadowRoot?.querySelectorAll("button.dot").forEach((e=>{e.tabIndex=-1,e.ariaHidden="true"})),this.dispatchEvent(i.c("refresh_focus",{title:v(),ariaLabel:v()+". "+e.S(3)})),this.events.define(s.d,(async e=>{e.stopPropagation(),this.submitButtonEnabled()&&(i.e(this,s.i(this.subreddit.topics.map((e=>e.displayName)),this.subreddit.topics.map((e=>e.id)))),this.dispatchSubredditUpdatedEvent("next"))})),this.events.define(s.h,(async e=>{e.stopPropagation(),this.dispatchSubredditUpdatedEvent("back")}))}dispatchSubredditUpdatedEvent(t){const a=new CustomEvent(e.U,{bubbles:!0,composed:!0,detail:{subreddit:{topics:this.filterSelected(this.gqlTopics)},direction:t,source:s.C.Topics}});this.dispatchEvent(a)}update(e){this.enableSubmitButtonIfValid(),e.has("subreddit")&&(this.selectedTopics=this.subreddit.topics?.map((e=>e.id))||[]),super.update(e)}filterSelected(e){let t=[];return e.forEach((e=>{this.selectedTopics.includes(e.id)&&t.push({...e,children:e.children??null});const a=e.children?this.filterSelected(e.children):[];a.length>0&&(t=t.concat(a))})),t}async loadTopics(){this._loading=!0;const e=await i.v({operation:i.O.TaxonomyTopicsInfo});this._loading=!1;const t=e.data?.taxonomyInfo?.topics;if(t)t.sort(((e,t)=>{const a=k.has(e.id),i=k.has(t.id);return a&&!i?1:!a&&i?-1:e.displayName.localeCompare(t.displayName)})),this.gqlTopics=t.map(y),this.topics=this.gqlTopics;else{const e="There was an error fetching topics. Please try again later.",t=i.c("faceplate-alert",{level:i.a4.error,cause:"uncategorized",message:e});this.dispatchEvent(t)}}dispatchWarningEvent(t,a,i){const n=new CustomEvent(e.C,{bubbles:!0,composed:!0,detail:{title:t,message:a,secondaryButton:i}});this.dispatchEvent(n)}submitButtonEnabled(){return this.selectedTopics.length>0&&this.selectedTopics.length<=N}enableSubmitButtonIfValid(){this.submitButton.disabled=!this.submitButtonEnabled()}renderTopics(){return 0===this.topics.length?a.x`<div> ${o.aq({attributes:{type:"button"},children:a.x`<span class="flex"><span class="select-none text-12 font-semibold">${"No topics match your search"} </span></span>`,leadingIcon:a.aP()})} </div>`:a.x`<div id="topics" class="flex flex-col gap-lg h-[250px] xs:h-[330px] overflow-x-hidden overflow-y-scroll"> ${this.topics.map((e=>this.renderTopic(e)),this)} </div>`;}renderTopic({children:e,displayName:t,icon:i}){return a.x` <fieldset aria-labelledby="title-${t}" class="topic-section p-0 m-0 border-0"> <legend> <h3 class="my-0 text-14">${i}<span class="ml-2xs">${t}</span></h3> </legend> ${e?a.x`<div class="flex flex-wrap gap-x-2xs gap-y-xs mt-2xs"> ${e.map((e=>this.renderTopicContainer(e,this.selectedTopics.indexOf(e.id)>-1)))} </div>`:a.A} </fieldset> `}renderTopicContainer(e,i){const n=()=>{this.onTopicsClick(!i,e.id)};return a.x` <div class="topic-container" id="container_${e.id}" data-topic="${e.displayName}"> <label for="${e.id}" class="group"> ${o.aq({selected:i,attributes:{id:e.id,type:"button","aria-pressed":i?"true":"false",onclick:n},deleteButtonConfig:{screenReaderContent:`${`Deselect topic ${e.displayName}`}`,attributes:{onclick:e=>{e.preventDefault(),e.stopPropagation(),n()},type:"button",id:`unselect-${e.id}`}},children:a.x`<span class="select-none text-12 font-semibold">${e.displayName} </span>`})} </label> </div> `;}renderSelectedTopics(){return a.x`<div id="selected-topics-container" class="min-h-[32px] h-fit flex flex-wrap justify-start gap-xs"> ${this.filterSelected(this.gqlTopics).map((e=>o.aq({children:e.displayName,selected:!0,attributes:{type:"button",id:`selected-topic-${e.id}`,className:"bg-neutral-background rounded-1 border-neutral-border",onclick:()=>{this.removeSelected(e.id)}},deleteButtonConfig:{screenReaderContent:`${`Deselect topic ${e.displayName}`}`,attributes:{onclick:()=>{this.removeSelected(e.id)},type:"button",id:`unselect-${e.id}`}}})))} </div>`;}render(){const e=this._loading?a.x`<shreddit-loading class="pointer-events-none h-[8rem] mt-4xl"></shreddit-loading>`:this.renderTopics();return a.x`<div class="w-96 h-16 pr-12 py-2.5 rounded-2xl justify-start items-center pb-xl inline-flex"> <div class="grow shrink basis-0 flex-col justify-center items-start gap-[4px] inline-flex"> <div class="self-stretch text-sm font-normal text-tone-2 leading-tight">${"Add up to 3 topics to help interested redditors find your community."}</div> </div> </div> <faceplate-search-input appearance="${r.T.SECONDARY}" class="w-full ml-0 mt-sm" type="text" name="filter" @input="${this.handleFilterChange}" value="${this.filter}" placeholder="${"Filter topics"}" novalidate inputmode></faceplate-search-input> <h3 class="w-full flex justify-start text-16 my-xs"> ${(t=this.selectedTopics.length.toString(), `Topics ${t}/3 `)} </h3> ${this.renderSelectedTopics()} <div data-testid="mature-label-container" class="w-96 text-danger-content min-h-[32px] text-xs font-normal"> ${this.maxTopicsSelected?i.bH({one:`Only ${N} topic can be added`,other:`Only ${N} topics can be added`,count:N}):this.selectedTopics.filter((e=>k.has(e))).length>0?"Selecting Mature topics labels your community as 18+ and limits discovery":""} </div> ${e} <slot></slot> <div class="pt-[40px]"> <slot name="buttons-bar"></slot> </div>`;var t}};I.styles=[i.t,i.j(".bg-rose-100 {\n  background-color: #fceee8;\n}\n.bg-slate-200 {\n  background-color: #e5ebee;\n}\n.fieldset-disabled {\n  opacity: 0.4;\n  pointer-events: none;\n}\n.bg-parent-topic-selected {\n  background-color: #d4c4c4;\n}\n")],a._([a.b()],I.prototype,"subreddit",void 0),a._([a.b()],I.prototype,"selectedTopics",void 0),a._([a.b()],I.prototype,"topics",void 0),a._([a.b()],I.prototype,"_loading",void 0),a._([a.b()],I.prototype,"maxTopicsSelected",void 0),I=a._([a.c("community-creation-topic-selection")],I);const T=[{value:i.eN.Public},{value:i.eN.Restricted},{value:i.eN.Private},{adminRequired:!0,value:i.eN.EmployeesOnly}],x=()=>"What kind of community is this?",R=()=>"Community marked as Mature (18+) \n because you selected a mature topic",S=a.s;let E=class extends S{constructor(){super(...arguments),this.events=new i.E(this,(()=>window)),this.subreddit={type:i.eN.Public,isNSFW:!1},this.isAdmin=!1,this.forceNSFW=!1,this.renderRadioItem=t=>{const i=t.value===this.subreddit.type,{label:n,description:s,icon:r,iconSelected:l}=o.cX({type:t.value})??{};return a.x`<label> ${d.l({onClick:()=>this.subreddit=e.u(this.subreddit,{type:t.value}),label:n??"",size:d.L.Medium,attributes:{role:"menuitemradio"},leadingIcon:i?l:r,trailingSlot:a.x`<faceplate-radio-input class="m-0" @input="${this.typeInputChangeHandler}" ?checked="${i}" name="type" value="${t.value}"></faceplate-radio-input>`,description:s,selected:i})} </label>`}}get _isSubredditNsfw(){return this.subreddit.isNSFW||this.forceNSFW}typeInputChangeHandler(t){const a=t.target.value;this.subreddit=e.u(this.subreddit,{type:a})}renderTypeInput(){return a.x` <div class="mb-xs"> <ul role="menu" class="pl-0"> ${T.map((e=>e.adminRequired&&!this.isAdmin?a.A:this.renderRadioItem(e)))} </ul> </div> `}async firstUpdated(t){super.firstUpdated(t);for(const e of this.subreddit.topics||[])if(k.has(e.id)){this.forceNSFW=!0;break}await this.updateComplete,this.querySelector("faceplate-pagination-indicator")?.shadowRoot?.querySelectorAll("button.dot").forEach((e=>{e.tabIndex=-1,e.ariaHidden="true"})),this.dispatchEvent(i.c("refresh_focus",{title:x(),ariaLabel:x()+". "+e.S(4)})),this.events.define(s.d,(async e=>{e.stopPropagation(),i.e(this,s.j(this.subreddit.type.toString())),i.e(this,s.n(this._isSubredditNsfw)),this.dispatchSubredditUpdatedEvent("next")})),this.events.define(s.h,(async e=>{e.stopPropagation(),this.dispatchSubredditUpdatedEvent("back")}))}dispatchSubredditUpdatedEvent(t){const a=new CustomEvent(e.U,{bubbles:!0,composed:!0,detail:{subreddit:{...this.subreddit,isNSFW:this._isSubredditNsfw},direction:t,source:s.C.Type}});this.dispatchEvent(a)}renderNsfwInput(){const t=this._isSubredditNsfw,i=a.x`<span class="w-full min-w-100 ${this.forceNSFW?"opacity-75":""}"> ${d.l({onClick:()=>{this.forceNSFW||(this.subreddit=e.u(this.subreddit,{isNSFW:!t}))},label:"Mature (18+) ",attributes:{role:"menuitemcheckbox"},size:d.L.Medium,leadingIcon:t?a.a8():a.bR(),trailingSlot:a.x` <faceplate-switch-input class="-mr-xs" data-testid="nsfw-input" name="isNsfw" ?checked="${t}" @click="${e=>{this.forceNSFW&&e.preventDefault()}}"> </faceplate-switch-input> `,description:"Users must be over 18 to view and contribute"})} </span>`;return this.forceNSFW?a.x`<rpl-tooltip placement="bottom-start" appearance="inverted" trigger="hover" class="w-full" style="--show-delay:100ms"> ${i} ${a.x`<div class="w-[190px]" slot="content">${R()}</div>`} </rpl-tooltip>`:i}render(){return a.x`<div class="min-h-[600px]"> <div class="w-96 h-16 pr-12 py-2.5 rounded-2xl justify-start items-center pb-xl inline-flex"> <div class="grow shrink basis-0 flex-col justify-center items-start gap-[4px] inline-flex"> <div class="self-stretch text-sm font-normal text-tone-2 leading-tight">${a.x`Decide who can view and contribute in your community. Only public communities show up in search. <strong>Important:</strong> Once set, you will need to submit a request to change your community type.`}</div> </div> </div> ${this.renderTypeInput()} <div class="w-full h-0 border border-black border-opacity-20 mb-sm border-solid"></div> ${this.forceNSFW?a.x`<div class="w-96 text-danger-content text-xs font-normal"> ${R()} </div>`:a.A} ${this.renderNsfwInput()} <slot name="buttons-bar"></slot> </div>`;}};E.styles=[i.j("\n    @media (max-width: 400px) {\n      :host {\n        --horizontal-padding: 16px;\n        --topbar-horizontal-padding: 16px;\n        max-height: none;\n        width: 100%;\n        max-width: none;\n        border-radius: 0;\n        margin-top: 20px;\n        padding-bottom: 0;\n        transition: padding-bottom 200ms ease-in-out;\n        z-index: 5;\n        min-height:100vh;\n      }\n    }"),i.t],a._([a.b()],E.prototype,"subreddit",void 0),a._([a.n({type:Boolean,attribute:"admin"})],E.prototype,"isAdmin",void 0),a._([a.b()],E.prototype,"forceNSFW",void 0),E=a._([a.c("community-creation-walkthrough-type")],E);const z="white",$="#63f050",D="black";let C=class extends a.s{constructor(){super(...arguments),this.fileName="cropped_image.png",this.canvasClasses="w-100 h-100",this.selectionWidth=100,this.selectionHeight=100,this.keepAspectRatio=!0,this.resizable=!0,this.adjustSelectionToBorder=!1,this._canvasEvents=new i.E(this,(()=>this.canvas)),this.imageSaved=!1,this.imageToRender=new Image,this.imagePosition={x:0,y:0,width:0,height:0},this.scale=1,this.guide={x:0,y:0,width:0,height:0},this.isDragging=!1,this.resizeCorner="",this.offsetX=0,this.offsetY=0,this.zoomLevel=1,this.maxZoomLevel=3,this.onMouseDown=e=>{const t=this.canvas.getBoundingClientRect();let a,i;e instanceof MouseEvent?(a=e.clientX-t.left,i=e.clientY-t.top):(a=e.touches[0].clientX-t.left,i=e.touches[0].clientY-t.top);if(a>=this.guide.x-8&&a<=this.guide.x+this.guide.width+8&&i>=this.guide.y-8&&i<=this.guide.y+this.guide.height+8){this.offsetX=a-this.guide.x,this.offsetY=i-this.guide.y;const e=16;a>=this.guide.x-e/2&&a<=this.guide.x+e/2&&i>=this.guide.y-e/2&&i<=this.guide.y+e/2?this.resizeCorner="top-left":a>=this.guide.x+this.guide.width-e/2&&a<=this.guide.x+this.guide.width+e/2&&i>=this.guide.y-e/2&&i<=this.guide.y+e/2?this.resizeCorner="top-right":a>=this.guide.x-e/2&&a<=this.guide.x+e/2&&i>=this.guide.y+this.guide.height-e/2&&i<=this.guide.y+this.guide.height+e/2?this.resizeCorner="bottom-left":a>=this.guide.x+this.guide.width-e/2&&a<=this.guide.x+this.guide.width+e/2&&i>=this.guide.y+this.guide.height-e/2&&i<=this.guide.y+this.guide.height+e/2?this.resizeCorner="bottom-right":this.isDragging=!0}},this.onMouseMove=e=>{const t=this.canvas.getBoundingClientRect();let a,i;e instanceof MouseEvent?(a=e.clientX-t.left,i=e.clientY-t.top):(a=e.touches[0].clientX-t.left,i=e.touches[0].clientY-t.top);a>=this.guide.x-8&&a<=this.guide.x+this.guide.width+8&&i>=this.guide.y-8&&i<=this.guide.y+this.guide.height+8?this.canvas.style.cursor="move":this.canvas.style.cursor="default",this.isDragging?this.moveSelectionArea(e):this.resizable&&this.resizeCorner&&this.resizeSelectionArea(e)},this.onMouseUp=()=>{this.isDragging=!1,this.resizeCorner=""},this.handleCancelKeyUp=e=>{"Enter"===e.key&&this.cancelClick()},this.handleSaveKeyUp=e=>{"Enter"===e.key&&this.saveCroppedImage()}}get canvas(){return this.shadowRoot.querySelector("canvas")}drawSelectionArea(e){e.strokeStyle=z,e.lineWidth=2,e.strokeRect(this.guide.x,this.guide.y,this.guide.width,this.guide.height);e.fillStyle="rgba(0, 0, 0, 0.3)",e.fillRect(0,0,this.guide.x,this.canvas.height),e.fillRect(this.guide.x+this.guide.width,0,this.canvas.width-(this.guide.x+this.guide.width),this.canvas.height),e.fillRect(this.guide.x,0,this.guide.width,this.guide.y),e.fillRect(this.guide.x,this.guide.y+this.guide.height,this.guide.width,this.canvas.height-(this.guide.y+this.guide.height))}drawResizeHandles(e){e.fillStyle=z,e.strokeStyle=D,e.lineWidth=1,e.fillRect(this.guide.x-4,this.guide.y-4,8,8),e.strokeRect(this.guide.x-4,this.guide.y-4,8,8),e.fillRect(this.guide.x+this.guide.width-4,this.guide.y-4,8,8),e.strokeRect(this.guide.x+this.guide.width-4,this.guide.y-4,8,8),e.fillRect(this.guide.x-4,this.guide.y+this.guide.height-4,8,8),e.strokeRect(this.guide.x-4,this.guide.y+this.guide.height-4,8,8),e.fillStyle=$,e.strokeStyle=$,e.fillRect(this.guide.x+this.guide.width-4,this.guide.y+this.guide.height-4,8,8),e.strokeRect(this.guide.x+this.guide.width-4,this.guide.y+this.guide.height-4,8,8)}drawCanvas(){if(this.imgSrc){const e=this.canvas.getContext("2d");if(e){e.clearRect(0,0,this.canvas.width,this.canvas.height),e.fillStyle=D,e.fillRect(0,0,this.canvas.width,this.canvas.height);const t=this.imagePosition.width*this.zoomLevel,a=this.imagePosition.height*this.zoomLevel,i=(this.canvas.width-t)/2,n=(this.canvas.height-a)/2;e.drawImage(this.imageToRender,i,n,t,a),this.drawSelectionArea(e),this.resizable&&this.drawResizeHandles(e)}}}moveSelectionArea(e){const t=this.canvas.getBoundingClientRect();let a,i;e instanceof MouseEvent?(a=e.clientX-t.left,i=e.clientY-t.top):(a=e.touches[0].clientX-t.left,i=e.touches[0].clientY-t.top);let n=a-this.offsetX;n<0?n=0:n+this.guide.width>this.canvas.width&&(n=this.canvas.width-this.guide.width);let s=i-this.offsetY;s<0?s=0:s+this.guide.height>this.canvas.height&&(s=this.canvas.height-this.guide.height),this.guide.x=n,this.guide.y=s,this.drawCanvas()}resizeSelectionArea(e){const t=this.canvas.getBoundingClientRect();let a;a=e instanceof MouseEvent?e.clientX-t.left:e.touches[0].clientX-t.left;const i=30;let n=0,s=0;switch(this.resizeCorner){case"top-left":n=this.guide.width-(a-this.guide.x),n=n>i?n:i,s=n*(this.keepAspectRatio?this.guide.height/this.guide.width:1),this.guide.x=a,this.guide.y+=this.guide.height-s,this.guide.width-=n,this.guide.height=s;break;case"top-right":n=a-this.guide.x,n=n>i?n:i,s=n*(this.keepAspectRatio?this.guide.height/this.guide.width:1),this.guide.y+=this.guide.height-s,this.guide.width=n,this.guide.height=s;break;case"bottom-left":n=this.guide.width-(a-this.guide.x),n=n>i?n:i,s=n*(this.keepAspectRatio?this.guide.height/this.guide.width:1),this.guide.x=a,this.guide.width=n,this.guide.height=s;break;case"bottom-right":n=a-this.guide.x,n=n>i?n:i,s=n*(this.keepAspectRatio?this.guide.height/this.guide.width:1),this.guide.width=n,this.guide.height=s}n>0&&s>0&&(this.guide.width=n,this.guide.height=s,this.drawCanvas())}saveCroppedImage(){const e=1/this.scale,t=document.createElement("canvas"),a=t.getContext("2d");t.width=this.canvas.width*e,t.height=this.canvas.height*e;const i=this.imagePosition.width*e*this.zoomLevel,n=this.imagePosition.height*e*this.zoomLevel,s=(t.width-i)/2,r=(t.height-n)/2;a.drawImage(this.imageToRender,s,r,i,n);const o=this.guide.x*e,l=this.guide.y*e,d=this.guide.width*e,u=this.guide.height*e,m=document.createElement("canvas"),c=m.getContext("2d");m.width=d,m.height=u,c.drawImage(t,o,l,d,u,0,0,d,u),this.imageSaved=!0,m.toBlob((e=>{if(e&&this.onSave){const t=new File([e],this.fileName,{type:"image/png"});this.onSave(t)}}))}zoomIn(){this.zoomLevel<this.maxZoomLevel&&(this.zoomLevel+=.1,this.drawCanvas())}zoomOut(){this.zoomLevel>.5&&(this.zoomLevel-=.1,this.drawCanvas())}resizeImage(){this.scale=Math.min(this.canvas.width/this.imageToRender.width,this.canvas.height/this.imageToRender.height),this.imagePosition.width=this.imageToRender.width*this.scale,this.imagePosition.height=this.imageToRender.height*this.scale,this.imagePosition.x=(this.canvas.width-this.imagePosition.width)/2,this.imagePosition.y=(this.canvas.height-this.imagePosition.height)/2,this.adjustSelectionToBorder&&(this.imagePosition.width<this.imagePosition.height?this.adjustSelectionToWidth():this.adjustSelectionToHeight())}adjustSelectionToWidth(){const e=this.guide.width,t=this.guide.height;this.guide.width=this.imagePosition.width;let a=this.selectionHeight;this.keepAspectRatio&&(a=this.guide.width/this.selectionWidth*this.selectionHeight),a>this.canvas.height&&(a=this.canvas.height-5,this.guide.width=a/this.selectionHeight*this.selectionWidth),this.guide.height=a,this.guide.x=this.guide.x-(this.guide.width-e)/2,this.keepAspectRatio&&(this.guide.y=this.guide.y-(this.guide.height-t)/2)}adjustSelectionToHeight(){const e=this.guide.height,t=this.guide.width;this.guide.height=this.imagePosition.height;let a=this.selectionWidth;this.keepAspectRatio&&(a=this.guide.height/this.selectionHeight*this.selectionWidth),a>this.canvas.width&&(a=this.canvas.width-5,this.guide.height=a/this.selectionWidth*this.selectionHeight),this.guide.width=a,this.guide.y=this.guide.y-(this.guide.height-e)/2,this.keepAspectRatio&&(this.guide.x=this.guide.x-(this.guide.width-t)/2)}addCanvasEventListeners(){this._canvasEvents.define("mousedown",this.onMouseDown),this._canvasEvents.define("mousemove",this.onMouseMove),this._canvasEvents.define("mouseup",this.onMouseUp),this._canvasEvents.define("mouseout",this.onMouseUp),this._canvasEvents.define("touchstart",this.onMouseDown),this._canvasEvents.define("touchmove",this.onMouseMove),this._canvasEvents.define("touchend",this.onMouseUp)}async firstUpdated(){this.addCanvasEventListeners(),this.canvas.width=this.canvas.getBoundingClientRect().width,this.canvas.height=this.canvas.getBoundingClientRect().height,this.guide={x:this.canvas.getBoundingClientRect().width-this.selectionWidth/2,y:(this.canvas.getBoundingClientRect().height-this.selectionHeight)/2,width:this.selectionWidth,height:this.selectionHeight},this.imageToRender.onload=()=>{this.resizeImage(),this.drawCanvas()},this.imageToRender.src=this.imgSrc||""}updated(e){(e.has("selectionWidth")||e.has("selectionHeight"))&&(this.guide.width=parseInt(this.selectionWidth.toString()),this.guide.height=parseInt(this.selectionHeight.toString()),this.guide.x=(this.canvas.getBoundingClientRect().width-parseInt(this.selectionWidth.toString()))/2,this.guide.y=(this.canvas.getBoundingClientRect().height-parseInt(this.selectionHeight.toString()))/2,this.drawCanvas()),super.updated(e)}cancelClick(){this.onCancel&&this.onCancel()}render(){return a.x` <div class="${this.canvasClasses}"> <div class="p-xs bg-black rounded-1 h-100 w-100" style="${this.canvasWidth?`width:${this.canvasWidth}px; `:""}${this.canvasHeight?`height:${this.canvasHeight}px;`:""}"> <canvas class="w-full h-full inline-block"></canvas> </div> <div class="flex justify-between pt-xs"> <div class="flex justify-start gap-[8px]"> <div class="flex flex-col"> ${i.k({appearance:"secondary",attributes:{type:"square",onclick:this.zoomOut,"aria-label":"Zoom out"},shape:"square",size:i._.Small,leadingIcon:a.dv({size:a.q.Small})})} </div> <div class="flex flex-col"> ${i.k({appearance:"secondary",attributes:{type:"button",onclick:this.zoomIn,"aria-label":"Zoom in"},shape:"square",size:i._.Small,leadingIcon:a.am({size:a.q.Small})})} </div> </div> <div class="flex justify-end"> <div @click="${this.cancelClick}" @keyup="${this.handleCancelKeyUp}"> ${this.cancelButton?this.cancelButton:i.k({appearance:"secondary",attributes:{id:"image-cropper-cancel-button",className:"ml-sm","data-testid":"submit-button",type:"submit",slot:"primaryButton"},children:"Cancel",size:i._.Small})} </div> <div @click="${this.saveCroppedImage}" @keyup="${this.handleSaveKeyUp}"> ${this.saveButton?this.saveButton:i.k({appearance:"primary",attributes:{id:"image-cropper-save-button",className:"ml-sm","data-testid":"submit-button",type:"submit",slot:"primaryButton"},children:"Save",size:i._.Small})} </div> </div> </div> </div> `;}};C.styles=[a.i`:host{display:block;padding:20px}`,i.t],a._([a.n({type:String,attribute:"file-name"})],C.prototype,"fileName",void 0),a._([a.n({type:String,attribute:"canvas-classes"})],C.prototype,"canvasClasses",void 0),a._([a.n({type:String,attribute:"img-src"})],C.prototype,"imgSrc",void 0),a._([a.n({type:Number,attribute:"selection-width"})],C.prototype,"selectionWidth",void 0),a._([a.n({type:Number,attribute:"selection-height"})],C.prototype,"selectionHeight",void 0),a._([a.n({type:Number})],C.prototype,"canvasWidth",void 0),a._([a.n({type:Number})],C.prototype,"canvasHeight",void 0),a._([a.n()],C.prototype,"cancelButton",void 0),a._([a.n()],C.prototype,"onCancel",void 0),a._([a.n()],C.prototype,"saveButton",void 0),a._([a.n()],C.prototype,"onSave",void 0),a._([a.n({type:Boolean})],C.prototype,"keepAspectRatio",void 0),a._([a.n({type:Boolean})],C.prototype,"resizable",void 0),a._([a.n({type:Boolean,attribute:"adjust-selection-to-border"})],C.prototype,"adjustSelectionToBorder",void 0),a._([a.b()],C.prototype,"zoomLevel",void 0),a._([a.b()],C.prototype,"maxZoomLevel",void 0),C=a._([a.c("image-cropper")],C);const P=()=>"Style your community",L=()=>"Banner",A=()=>"Icon",w=a.s;let j=class extends w{constructor(){super(...arguments),this.events=new i.E(this,(()=>window)),this.subreddit={},this.editingImage=!1,this.editingImageType="",this.handleAvatarChange=t=>{const a=t.target;this.imageCropperProps={imageSrc:a.src,selectionHeight:300,selectionWidth:300,fileName:a.file.name,onSave:t=>{i.e(this,s.k()),this.editingImage=!1,this.subreddit=e.u(this.subreddit,{avatar:t})}},this.requestUpdate(),this.editingImage=!0,this.editingImageType="icon"},this.handleBannerChange=t=>{const a=t.target;this.imageCropperProps={imageSrc:a.src,selectionHeight:60,selectionWidth:500,fileName:a.file.name,onSave:t=>{i.e(this,s.m()),this.editingImage=!1,this.subreddit=e.u(this.subreddit,{banner:t})}},this.requestUpdate(),this.editingImage=!0,this.editingImageType="banner"},this.imagelistElements=[{getLabel:()=>a.x`${L()}`,getButton:()=>this.getButton(this.handleBannerChange,void 0!==this.subreddit.banner,L()),shouldDisplay:()=>!0,className:"",size:d.L.Medium},{getLabel:()=>a.x`<span class="text-12 text-coolgray-550">${this.subreddit.banner?.name||"banner image"}</span>`,getButton:()=>i.k({appearance:"plain",attributes:{"data-testid":"delete-banner",onclick:()=>{this.subreddit.banner=void 0,this.requestUpdate()},"aria-label":"Delete uploaded banner"},leadingIcon:a.ao({size:a.q.Small})}),shouldDisplay:()=>void 0!==this.subreddit.banner,className:"border-solid border border-tone-4 rounded-1 overflow-hidden",size:d.L.Small},{getLabel:()=>a.x`${A()}`,getButton:()=>this.getButton(this.handleAvatarChange,void 0!==this.subreddit.avatar,A()),shouldDisplay:()=>!0,className:"",size:d.L.Medium},{getLabel:()=>a.x`<span class="text-12 text-coolgray-550">${this.subreddit.avatar.name||"avatar image"}}</span>`,getButton:()=>i.k({appearance:"plain",attributes:{"data-testid":"delete-avatar",onclick:()=>{this.subreddit.avatar=void 0,this.requestUpdate()},"aria-label":"Delete uploaded avatar"},leadingIcon:a.ao({size:a.q.Small})}),shouldDisplay:()=>void 0!==this.subreddit.avatar,className:"border-solid border border-tone-4 rounded-1 overflow-hidden",size:d.L.Small}],this.renderElementList=e=>a.x`<label> ${e.shouldDisplay()?d.l({hasTransparentBackground:!0,onClick:()=>{},label:e.getLabel(),size:e.size,trailingSlot:e.getButton(),attributes:{className:e.className}}):""} </label>`}async firstUpdated(){await this.updateComplete,this.querySelector("faceplate-pagination-indicator")?.shadowRoot?.querySelectorAll("button.dot").forEach((e=>{e.tabIndex=-1,e.ariaHidden="true"})),this.dispatchEvent(i.c("refresh_focus",{title:P(),ariaLabel:P()+". "+e.S(2)})),this.events.define(s.d,(async e=>{e.stopPropagation(),this.dispatchSubredditUpdatedEvent("next")})),this.events.define(s.h,(async e=>{e.stopPropagation(),this.dispatchSubredditUpdatedEvent("back")}))}dispatchSubredditUpdatedEvent(t){const a=new CustomEvent(e.U,{bubbles:!0,composed:!0,detail:{subreddit:this.subreddit,direction:t,source:s.C.Images}});this.dispatchEvent(a)}getButton(e,t,i){return a.x`<community-image-upload dropzone-classes="border-none" accept="image/x-png,image/jpeg,image/png" @change="${e}" .customContent="${()=>this.renderButton(t?"bordered":"secondary",t?"Change":"Add",i)}"></community-image-upload>`;}renderButton(e,t,n){return a.x`${i.k({attributes:{"aria-label":t+" "+n},appearance:e,children:t,leadingIcon:a.dp(),size:i._.Small})}`}ImageInputs(){return a.x` <div class="mb-xs min-w-[55%]"> <ul role="menu" class="pl-0"> ${this.imagelistElements.map((e=>this.renderElementList(e)))} </ul> </div> `}render(){const e=a.x`<div class="min-w-[55%] xs:w-[768px] h-16 pr-12 py-2.5 rounded-2xl justify-start items-center pb-xl inline-flex"> <div class="grow shrink basis-0 flex-col justify-center items-start gap-[4px] inline-flex"> <div class="self-stretch text-sm font-normal text-tone-2 leading-tight w-[80%]"> ${this.editingImage?(t=this.editingImageType,"banner"===t?"Banners must be 1028px x 128px":"Icon must be 1:1"):"Adding visual flair will catch new members attention and help establish your community’s culture! You can update this at any time."} </div> </div> </div>`;var t;return this.editingImage?a.x` ${e} <div class="w-100 h-16 pr-12 py-2.5 rounded-2xl justify-start items-center pb-xl inline-flex"> <image-cropper class="max-w-[700px] w-[96%]" canvas-classes="w-100 h-[400px]" img-src="${a.l(this.imageCropperProps?.imageSrc)}" selection-width="${a.l(this.imageCropperProps?.selectionWidth)}" selection-height="${a.l(this.imageCropperProps?.selectionHeight)}" adjust-selection-to-border file-name="${a.l(this.imageCropperProps?.fileName)}" .onCancel="${()=>{this.editingImage=!1}}" .onSave="${this.imageCropperProps?.onSave}"></image-cropper> </div>`:a.x` ${e} <div class="flex gap-md flex-col-reverse xs:flex-row"> ${this.ImageInputs()} <div class="flex items-center grow"> <community-creation-preview class="w-100 flex justify-center" name="${a.l(this.subreddit.name)}" description="${a.l(this.subreddit.description)}" avatar="${this.subreddit.avatar?URL.createObjectURL(this.subreddit.avatar):""}" banner="${this.subreddit.banner?URL.createObjectURL(this.subreddit.banner):""}" show-default-images></community-creation-preview> </div> </div> <div class="mb-0 pt-[42px]"> <slot name="buttons-bar"></slot> </div> `}};j.styles=[i.t],a._([a.b()],j.prototype,"subreddit",void 0),a._([a.b()],j.prototype,"editingImage",void 0),a._([a.b()],j.prototype,"editingImageType",void 0),j=a._([a.c("community-creation-walkthrough-images")],j)}));